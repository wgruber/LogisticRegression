<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Anwendungsbeispiel | Logistische Regression</title>
  <meta name="description" content="Methodenlehre und Statistik 3" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Anwendungsbeispiel | Logistische Regression" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/Images/Cover.png" />
  <meta property="og:description" content="Methodenlehre und Statistik 3" />
  <meta name="github-repo" content="wgruber/LogisticRegression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Anwendungsbeispiel | Logistische Regression" />
  
  <meta name="twitter:description" content="Methodenlehre und Statistik 3" />
  <meta name="twitter:image" content="/Images/Cover.png" />

<meta name="author" content="W. R. Gruber" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="evaluierung-des-modells.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Logistische Regression</a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="vorbemerkung.html"><a href="vorbemerkung.html"><i class="fa fa-check"></i>Vorbemerkung</a></li>
<li class="chapter" data-level="" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i>Motivation</a>
<ul>
<li class="chapter" data-level="" data-path="motivation.html"><a href="motivation.html#beispiele-aus-der-psychologie"><i class="fa fa-check"></i>Beispiele aus der Psychologie</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="grundlegende-idee.html"><a href="grundlegende-idee.html"><i class="fa fa-check"></i>Grundlegende Idee</a>
<ul>
<li class="chapter" data-level="" data-path="grundlegende-idee.html"><a href="grundlegende-idee.html#einführendes-beispiel"><i class="fa fa-check"></i>Einführendes Beispiel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html"><i class="fa fa-check"></i>Theorie der logistischen Regression</a>
<ul>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#lineare-modelle"><i class="fa fa-check"></i>Lineare Modelle</a></li>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#logistische-funktion"><i class="fa fa-check"></i>Logistische Funktion</a></li>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#odds-ratio"><i class="fa fa-check"></i>Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#interpretation-der-odds-ratio-im-kontext-therapieerfolg"><i class="fa fa-check"></i>Interpretation der Odds-Ratio im Kontext Therapieerfolg</a>
<ul>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#a-fall-1-eb-1-kein-einfluss"><i class="fa fa-check"></i>a) Fall 1: <span class="math inline">\(e^{b} = 1\)</span> — Kein Einfluss</a></li>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#b-fall-2-eb-1-erhöhte-erfolgswahrscheinlichkeit"><i class="fa fa-check"></i>b) Fall 2: <span class="math inline">\(e^{b} &gt; 1\)</span> — Erhöhte Erfolgswahrscheinlichkeit</a></li>
<li class="chapter" data-level="" data-path="theorie-der-logistischen-regression.html"><a href="theorie-der-logistischen-regression.html#c-fall-3-eb-1-verringerte-erfolgswahrscheinlichkeit"><i class="fa fa-check"></i>c) Fall 3: <span class="math inline">\(e^{b} &lt; 1\)</span> — Verringerte Erfolgswahrscheinlichkeit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html"><i class="fa fa-check"></i>Evaluierung des Modells</a>
<ul>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#likelihood-und-log-likelihood"><i class="fa fa-check"></i>Likelihood und Log-Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#definition-der-likelihood"><i class="fa fa-check"></i>Definition der Likelihood</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#die-log-likelihood"><i class="fa fa-check"></i>Die Log-Likelihood</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#anwendung-in-der-parameterschätzung"><i class="fa fa-check"></i>Anwendung in der Parameterschätzung</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#anwendung-in-der-logistischen-regression"><i class="fa fa-check"></i>Anwendung in der Logistischen Regression</a>
<ul>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#die-deviance-statistic-delta-d"><i class="fa fa-check"></i>Die Deviance-Statistic (<span class="math inline">\(\Delta D\)</span>)</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#anschauliche-erklärung"><i class="fa fa-check"></i>Anschauliche Erklärung</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#wald-statistik"><i class="fa fa-check"></i>Wald Statistik</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#pseudobestimmtheitsmaß-pseudo-r2-oder-mcfaddens-r2"><i class="fa fa-check"></i>Pseudobestimmtheitsmaß (Pseudo-<span class="math inline">\(R^2\)</span> oder McFadden’s <span class="math inline">\(R^2\)</span>)</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#genauigkeit-accuracy"><i class="fa fa-check"></i>Genauigkeit (Accuracy)</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#präzision-precision"><i class="fa fa-check"></i>Präzision (Precision)</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#recall-sensitivität-oder-true-positive-rate"><i class="fa fa-check"></i>Recall (Sensitivität oder True Positive Rate)</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#f1-score"><i class="fa fa-check"></i>F1-Score</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#receiver-operating-characteristic-roc-curve"><i class="fa fa-check"></i>Receiver Operating Characteristic (ROC) Curve</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#area-under-the-roc-curve-auc-roc"><i class="fa fa-check"></i>Area Under the ROC Curve (AUC-ROC)</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#konfusionsmatrix-confusion-matrix"><i class="fa fa-check"></i>Konfusionsmatrix (Confusion Matrix):</a></li>
<li class="chapter" data-level="" data-path="evaluierung-des-modells.html"><a href="evaluierung-des-modells.html#zusammenfassung"><i class="fa fa-check"></i>Zusammenfassung</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html"><i class="fa fa-check"></i>Anwendungsbeispiel</a>
<ul>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#datenvorverarbeitung"><i class="fa fa-check"></i>Datenvorverarbeitung</a>
<ul>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#schlafprobleme-und-alkohol"><i class="fa fa-check"></i>Schlafprobleme und Alkohol</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#schlafprobleme-und-einkommen"><i class="fa fa-check"></i>Schlafprobleme und Einkommen</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#schlafprobleme-und-kaffe"><i class="fa fa-check"></i>Schlafprobleme und Kaffe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#modellanpassung"><i class="fa fa-check"></i>Modellanpassung</a>
<ul>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#zusammenhang-der-prädiktoren"><i class="fa fa-check"></i>Zusammenhang der Prädiktoren</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#vorhersagen"><i class="fa fa-check"></i>Vorhersagen</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#vorhersagen-mit-unserem-logistischen-modell"><i class="fa fa-check"></i>Vorhersagen mit unserem logistischen Modell</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#von-wahrscheinlichkeiten-zu-klassifikationen"><i class="fa fa-check"></i>Von Wahrscheinlichkeiten zu Klassifikationen</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#modellevaluierung"><i class="fa fa-check"></i>Modellevaluierung</a>
<ul>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#genauigkeit-accuracy-1"><i class="fa fa-check"></i>Genauigkeit (Accuracy)</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#sensitivität-spezifität-und-die-konfusionsmatrix"><i class="fa fa-check"></i>Sensitivität, Spezifität und die Konfusionsmatrix</a></li>
<li class="chapter" data-level="" data-path="anwendungsbeispiel.html"><a href="anwendungsbeispiel.html#roc-auc"><i class="fa fa-check"></i>ROC &amp; AUC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://wgruber.github.io/LogisticRegression" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Logistische Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anwendungsbeispiel" class="section level1 hasAnchor">
<h1>Anwendungsbeispiel<a href="anwendungsbeispiel.html#anwendungsbeispiel" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- siehe auch: https://bookdown.org/brianmachut/uofm_analytics_r_hw_sol_2/logreg.html -->
<p>Als Mitarbeiter einer groß angelegten Schlafstudie haben Sie die Aufgabe, die Faktoren, die zu Schlafstörung führen, besser zu verstehen. Außerdem möchten Sie dieses Wissen nutzen, um bei Vorliegen einer Schlafstörung eingreifen und die Gesundheit und Lebensqualität dieser Personen verbessern zu können. Sie möchten also die Wahrscheinlichkeit vorhersagen können, dass eine Person mit (einem) bestimmten Merkmale(n) eine Schlafstörung hat.</p>
<p>Folgende Daten<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> liegen für Ihre Analysen vor:</p>
<ul>
<li><code>sleep_problem</code>: gibt an, ob eine Person ein Schlafproblem hat (1 = ja; 0 = nein)</li>
<li><code>coffee_drinker</code>: gibt an, ob eine Person regelmäßig Kaffee trinkt (1 = ja, Kaffeetrinker; 0 = kein Kaffeetrinker)</li>
<li><code>alcohol</code>: jährlichen Ausgaben für Alkohol</li>
<li><code>income</code>: das Jahreseinkommen</li>
</ul>
<p>Dieser Datensatz steht im Blackboard zum Download zur Verfügung (<em>sleep_data.csv</em>).</p>
<div id="datenvorverarbeitung" class="section level2 hasAnchor">
<h2>Datenvorverarbeitung<a href="anwendungsbeispiel.html#datenvorverarbeitung" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="anwendungsbeispiel.html#cb4-1" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb4-2"><a href="anwendungsbeispiel.html#cb4-2" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>) </span>
<span id="cb4-3"><a href="anwendungsbeispiel.html#cb4-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span>
<span id="cb4-4"><a href="anwendungsbeispiel.html#cb4-4" tabindex="-1"></a>  pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, pROC, psych, readr, stats)</span>
<span id="cb4-5"><a href="anwendungsbeispiel.html#cb4-5" tabindex="-1"></a>  sleep_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Daten/sleep_data.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-6"><a href="anwendungsbeispiel.html#cb4-6" tabindex="-1"></a>  <span class="co"># sleep_data &lt;- sleep_data %&gt;% </span></span>
<span id="cb4-7"><a href="anwendungsbeispiel.html#cb4-7" tabindex="-1"></a>  <span class="co">#   dplyr::mutate(sleep_problem  = ifelse(sleep_problem  == 1, &quot;Yes&quot;, &quot;No&quot;))%&gt;% </span></span>
<span id="cb4-8"><a href="anwendungsbeispiel.html#cb4-8" tabindex="-1"></a>  <span class="co">#   dplyr::mutate(coffee_drinker = ifelse(coffee_drinker == 1, &quot;Yes&quot;, &quot;No&quot;))</span></span>
<span id="cb4-9"><a href="anwendungsbeispiel.html#cb4-9" tabindex="-1"></a>  sleep_data<span class="sc">$</span>sleep_problem <span class="ot">&lt;-</span> <span class="fu">factor</span>(sleep_data<span class="sc">$</span>sleep_problem, </span>
<span id="cb4-10"><a href="anwendungsbeispiel.html#cb4-10" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb4-11"><a href="anwendungsbeispiel.html#cb4-11" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb4-12"><a href="anwendungsbeispiel.html#cb4-12" tabindex="-1"></a>  sleep_data<span class="sc">$</span>coffee_drinker <span class="ot">&lt;-</span> <span class="fu">factor</span>(sleep_data<span class="sc">$</span>coffee_drinker, </span>
<span id="cb4-13"><a href="anwendungsbeispiel.html#cb4-13" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb4-14"><a href="anwendungsbeispiel.html#cb4-14" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span></code></pre></div>
<p>Um den Zusammenhang zwischen den einzelnen Prädiktoren und Schlafstörung besser zu verstehen, sollte man vor der Analyse die Daten deskriptiv (Tabellen, Kennwerte und Graphiken) betrachten. Wir erstellen dazu im ersten Schritt Graphiken.</p>
<div id="schlafprobleme-und-alkohol" class="section level3 hasAnchor">
<h3>Schlafprobleme und Alkohol<a href="anwendungsbeispiel.html#schlafprobleme-und-alkohol" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Offenbar haben Personen, die viel Geld für Alkohol ausgeben auch häufiger Schlafprobleme. Beachtenswert sind sowohl bei den Personen die über keine Schlafprobleme berichten, einige mit sehr hohen Ausgaben für Alkohol dabei sind, aber auch ein paar Leute wenig Geld ausgeben, aber trotzdem Schalfprobleme haben. Wie könnte man das deuten?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="anwendungsbeispiel.html#cb5-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> sleep_problem, </span>
<span id="cb5-2"><a href="anwendungsbeispiel.html#cb5-2" tabindex="-1"></a>                                <span class="at">y =</span> alcohol_spend, </span>
<span id="cb5-3"><a href="anwendungsbeispiel.html#cb5-3" tabindex="-1"></a>                                <span class="at">fill =</span> sleep_problem)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="anwendungsbeispiel.html#cb5-4" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb5-5"><a href="anwendungsbeispiel.html#cb5-5" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Sleep Problem (Y/N)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="anwendungsbeispiel.html#cb5-6" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Annual expenditure on alcohol&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="anwendungsbeispiel.html#cb5-7" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Figure 1: Alcohol expenditures and Sleep Problems&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="anwendungsbeispiel.html#cb5-8" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="01_LogisticRegression_files/figure-html/Sleep_Boxplot_1-1.png" width="672" /></p>
</div>
<div id="schlafprobleme-und-einkommen" class="section level3 hasAnchor">
<h3>Schlafprobleme und Einkommen<a href="anwendungsbeispiel.html#schlafprobleme-und-einkommen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Das Einkommen dürfte keinen beachtenswerten Einfluss auf die Schlafprobleme haben.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="anwendungsbeispiel.html#cb6-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> sleep_problem, <span class="at">y =</span> income, <span class="at">fill =</span> sleep_problem)) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="anwendungsbeispiel.html#cb6-2" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb6-3"><a href="anwendungsbeispiel.html#cb6-3" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Sleep Problem (Y/N)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="anwendungsbeispiel.html#cb6-4" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Income&quot;</span>) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="anwendungsbeispiel.html#cb6-5" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Figure 2: Income and and Sleep Problems&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="anwendungsbeispiel.html#cb6-6" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="01_LogisticRegression_files/figure-html/Sleep_Boxplot_2-1.png" width="672" /></p>
</div>
<div id="schlafprobleme-und-kaffe" class="section level3 hasAnchor">
<h3>Schlafprobleme und Kaffe<a href="anwendungsbeispiel.html#schlafprobleme-und-kaffe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hier kann man einen Effekt des Kaffees feststellen. Offenbar hat ein höherer Anteil an Personen die Kaffeetrinker sind Schlafprobleme. Ob der Unterschied zwischen den beiden Gruppen statistisch bedeutsam ist, bleibt noch zu zeigen!</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="anwendungsbeispiel.html#cb7-1" tabindex="-1"></a>  sleep_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="anwendungsbeispiel.html#cb7-2" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">group_by</span>(sleep_problem, coffee_drinker) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="anwendungsbeispiel.html#cb7-3" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="anwendungsbeispiel.html#cb7-4" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="anwendungsbeispiel.html#cb7-5" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">group_by</span>(coffee_drinker) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="anwendungsbeispiel.html#cb7-6" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_coffee_drinkers =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="anwendungsbeispiel.html#cb7-7" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="anwendungsbeispiel.html#cb7-8" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> total_coffee_drinkers) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="anwendungsbeispiel.html#cb7-9" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(sleep_problem <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="anwendungsbeispiel.html#cb7-10" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> coffee_drinker, <span class="at">y =</span> proportion, <span class="at">fill =</span> coffee_drinker)) <span class="sc">+</span> </span>
<span id="cb7-11"><a href="anwendungsbeispiel.html#cb7-11" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-12"><a href="anwendungsbeispiel.html#cb7-12" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-13"><a href="anwendungsbeispiel.html#cb7-13" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;Percent with Sleep Problems&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-14"><a href="anwendungsbeispiel.html#cb7-14" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;Coffee Drinker (Y/N)&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="anwendungsbeispiel.html#cb7-15" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="st">&quot;Figure 3: Percent of Coffee Drinkers with Sleep Problems&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="anwendungsbeispiel.html#cb7-16" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Coffee Drinker&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-17"><a href="anwendungsbeispiel.html#cb7-17" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;sleep_problem&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="01_LogisticRegression_files/figure-html/Sleep_Barplot-1.png" width="672" /></p>
</div>
</div>
<div id="modellanpassung" class="section level2 hasAnchor">
<h2>Modellanpassung<a href="anwendungsbeispiel.html#modellanpassung" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Die Anpassung eines logistischen Regressionsmodells in <strong>R</strong> ist der linearen Regression sehr ähnlich.</p>
<p>Statt der Funktion <code>lm()</code> verwenden wir die Funktion <code>glm()</code> für <strong>G</strong>eneralized <strong>L</strong>inear <strong>M</strong>odells (verallgemeinerte lineare Modelle).</p>
<p>Zusätzlich zu den Formel- und Datenargumenten benötigt die <code>glm()</code>-Funktion das Argument <em>family</em>, mit der die <em>Verteilungs</em>- und <em>Link</em>-funktion definiert wird. Die Verwendung des Arguments <code>family = binomial</code> teilt <strong>R</strong> mit, dass eine logistische Regression anstelle eines anderen GLM-Typs durchführt werden soll.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="anwendungsbeispiel.html#cb9-1" tabindex="-1"></a>  log_reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> sleep_problem <span class="sc">~</span> coffee_drinker <span class="sc">+</span> </span>
<span id="cb9-2"><a href="anwendungsbeispiel.html#cb9-2" tabindex="-1"></a>                                           alcohol_spend <span class="sc">+</span></span>
<span id="cb9-3"><a href="anwendungsbeispiel.html#cb9-3" tabindex="-1"></a>                                           income,</span>
<span id="cb9-4"><a href="anwendungsbeispiel.html#cb9-4" tabindex="-1"></a>                    <span class="at">data =</span> sleep_data,</span>
<span id="cb9-5"><a href="anwendungsbeispiel.html#cb9-5" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>))</span>
<span id="cb9-6"><a href="anwendungsbeispiel.html#cb9-6" tabindex="-1"></a>  <span class="fu">summary</span>(log_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sleep_problem ~ coffee_drinker + alcohol_spend + 
##     income, family = binomial(link = &quot;logit&quot;), data = sleep_data)
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -1.09e+01   4.92e-01  -22.08   &lt;2e-16 ***
## coffee_drinkerYes -6.47e-01   2.36e-01   -2.74   0.0062 ** 
## alcohol_spend      2.29e-03   9.28e-05   24.74   &lt;2e-16 ***
## income             3.03e-06   8.20e-06    0.37   0.7115    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1571.5  on 9996  degrees of freedom
## AIC: 1580
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>Die Tabelle enthält weniger Informationen als beim linearen Modell, da die Verteilung der Abweichungsresiduen nicht so wichtig ist und es kein <span class="math inline">\(R^2\)</span> gibt, da es für die logistische Regression nicht definiert ist.</p>
<p>Die Koeffizienten entsprechen der Veränderung der <em>logarithmischen Quoten</em> für eine Erhöhung des Prädiktors um eine Einheit. Die <span class="math inline">\(p\)</span>-Werte werden ähnlich wie bei der linearen Regression interpretiert - im Wesentlichen zeigen kleine p-Werte an, dass wir die <span class="math inline">\(H_0\)</span> ablehnen, also dass die abhängige Variable nicht vom Prädiktor abhängt.</p>
<p>Wir können also daraus schließen, dass ein Zusammenhang zwischen dem Prädiktor und der abhängigen Variablen (Schlafprobleme) besteht. Für die vorliegenden Ergebnisse bedeutet das:</p>
<ul>
<li><p><strong>Intercept</strong>: Der geschätzte Achsenabschnitt ist normalerweise nicht von Interesse</p></li>
<li><p><strong>Kaffeetrinker</strong>: Kaffee trinken hat einen Koeffizienten <span class="math inline">\(b_1 = -0.65\)</span>, was bedeutet, dass Kaffeetrinken mit einer Verringerung der Wahrscheinlichkeit von Schlafproblemen verbunden ist. Konkret bedeutet dies, dass die Wahrscheinlichkeit von Schlafproblemen (im Vergleich zu Nicht-Kaffeetrinkern) um einen multiplikativen Faktor von <span class="math inline">\(e^{-0.65}\)</span> oder <span class="math inline">\(0.52\)</span> abnimmt, wenn alle anderen Prädiktoren unverändert bleiben.Dieser Zusammenhang scheint signifikant zu sein.</p></li>
<li><p><strong>Ausgaben für Alkohol</strong>: Ein Anstieg der Ausgaben für Alkohol um eine Einheit ist mit einem Anstieg der logarithmischen Wahrscheinlichkeit, an einer Schlafstörung zu leiden, um <span class="math inline">\(0.0023\)</span> verbunden.</p></li>
<li><p><strong>Einkommen</strong>: Ein p-Wert von <span class="math inline">\(0.71\)</span> lässt den Schluss zu, dass das Einkommen nicht signifikant mit Schlafproblemen verbunden ist.</p></li>
</ul>
<p>Unser Modell sagt uns, dass Kaffeetrinken eine <em>Verringerung</em> der Wahrscheinlichkeit (likelihood) für Schlafstörungen bewirkt. Obige Grafik zeigt jedoch, dass der Anteil der Kaffeetrinker mit Herzkrankheiten höher war als der der Nicht-Kaffeetrinkern. Wie kann das sein?</p>
<div id="zusammenhang-der-prädiktoren" class="section level3 hasAnchor">
<h3>Zusammenhang der Prädiktoren<a href="anwendungsbeispiel.html#zusammenhang-der-prädiktoren" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="anwendungsbeispiel.html#cb11-1" tabindex="-1"></a>  PredCor <span class="ot">&lt;-</span> <span class="fu">cor</span>(sleep_data<span class="sc">$</span>alcohol_spend, </span>
<span id="cb11-2"><a href="anwendungsbeispiel.html#cb11-2" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(sleep_data<span class="sc">$</span>coffee_drinker) <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Im vorliegenden Fall sind <em>Kaffeetrinken</em> und <em>Ausgaben für Alkohol</em> korreliert (<span class="math inline">\(r = 0.204\)</span>). Dadurch hat es den Anschein, dass Kaffetrinken einen günstigen Effekt auf die Schlafstörung hat und der Alkohol als positiver und signifikanter Effekt die Schlafstörung maßgeblich beeinflusst (<em>Bemerkung:</em> das Einkommen ist ja nicht signifikant!).</p>
</div>
</div>
<div id="vorhersagen" class="section level2 hasAnchor">
<h2>Vorhersagen<a href="anwendungsbeispiel.html#vorhersagen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Angenommen, eine bestimmte Person ist Kaffeetrinker, gibt 5.000 pro Jahr für Alkohol aus und hat ein Jahreseinkommen von 60.000 Euro. Wie hoch wäre die vorhergesagte Wahrscheinlichkeit für eine Schlafstörung auf Basis des Modells?</p>
<p><span class="math display">\[
p(X) = \frac{e^{-10.09 - 0.65 + 0.0023 \times 5000 + 0.00000303 \times 60000}}{1 + e^{-10.09 - 0.65 + 0.0023 \times 5000 + 0.00000303 \times 60000}} = 0.535
\]</span></p>
</div>
<div id="vorhersagen-mit-unserem-logistischen-modell" class="section level2 hasAnchor">
<h2>Vorhersagen mit unserem logistischen Modell<a href="anwendungsbeispiel.html#vorhersagen-mit-unserem-logistischen-modell" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Um Vorhersagen durch das Modell mit <strong>R</strong> zu berechnen, verwenden wir die <code>predict()</code>-Funktion. Die Option <code>type = "response"</code> sorgt dafür, dass <strong>R</strong> die Wahrscheinlichkeiten in der Form <span class="math inline">\(P(Y=1|X)\)</span> ausgibt.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="anwendungsbeispiel.html#cb12-1" tabindex="-1"></a>  test_obs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">coffee_drinker =</span> <span class="st">&quot;Yes&quot;</span>,</span>
<span id="cb12-2"><a href="anwendungsbeispiel.html#cb12-2" tabindex="-1"></a>                          <span class="at">alcohol_spend =</span> <span class="dv">5000</span>,</span>
<span id="cb12-3"><a href="anwendungsbeispiel.html#cb12-3" tabindex="-1"></a>                                 <span class="at">income =</span> <span class="dv">60000</span>)</span>
<span id="cb12-4"><a href="anwendungsbeispiel.html#cb12-4" tabindex="-1"></a>  <span class="fu">predict</span>(log_reg, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, test_obs)</span></code></pre></div>
<pre><code>##     1 
## 0.535</code></pre>
</div>
<div id="von-wahrscheinlichkeiten-zu-klassifikationen" class="section level2 hasAnchor">
<h2>Von Wahrscheinlichkeiten zu Klassifikationen<a href="anwendungsbeispiel.html#von-wahrscheinlichkeiten-zu-klassifikationen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Wir haben jetzt vorhergesagte Wahrscheinlichkeiten, aber wir müssen diese noch in Klassifikationen umwandeln. Mit anderen Worten: Sobald du eine vorhergesagte Wahrscheinlichkeit hast, wie entscheidest du, ob diese als „1“ (Schlafproblem) oder als „0“ (kein Schlafproblem) eingestuft werden soll?</p>
<p>Man könnte alle Personen mit einer vorhergesagten Wahrscheinlichkeit größer als <span class="math inline">\(P(Y=1|X) &gt; 0.50\)</span> als “1” einstufen, und alle mit einer Wahrscheinlichkeit kleiner als <span class="math inline">\(P(Y=1|X) \leq 0.50\)</span> als “0”.</p>
<p>Als Entscheidungs-Schwellenwert (engl. <em>prediction threshold</em>) würde man also den Wert 0,50 bestimmen. Allerdings ist es nicht immer so einfach, wie im nachfolgenden Beispiel gezeigt wird.</p>
</div>
<div id="modellevaluierung" class="section level2 hasAnchor">
<h2>Modellevaluierung<a href="anwendungsbeispiel.html#modellevaluierung" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="genauigkeit-accuracy-1" class="section level3 hasAnchor">
<h3>Genauigkeit (Accuracy)<a href="anwendungsbeispiel.html#genauigkeit-accuracy-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Die Genauigkeit (Accuracy) des Modells ist definiert als die Gesamtanzahl der korrekt vorhergesagten Fälle, geteilt durch die Gesamtanzahl der Beobachtungen. Betrachten wir zunächst die Genauigkeit des Modells für verschiedene Werte des Entscheidungsschwellenwerts:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="anwendungsbeispiel.html#cb14-1" tabindex="-1"></a>  pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_reg, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb14-2"><a href="anwendungsbeispiel.html#cb14-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="fu">round</span>(pred_probs, <span class="dv">3</span>), <span class="at">n =</span> <span class="dv">10</span>) <span class="co"># Print first 10 probabilities</span></span></code></pre></div>
<pre><code>##     1     2     3     4     5     6     7     8     9    10 
## 0.001 0.001 0.010 0.000 0.002 0.002 0.002 0.001 0.016 0.000</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="anwendungsbeispiel.html#cb16-1" tabindex="-1"></a>  thresh_1 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb16-2"><a href="anwendungsbeispiel.html#cb16-2" tabindex="-1"></a>  thresh_2 <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb16-3"><a href="anwendungsbeispiel.html#cb16-3" tabindex="-1"></a>  thresh_3 <span class="ot">&lt;-</span> <span class="fl">0.50</span></span>
<span id="cb16-4"><a href="anwendungsbeispiel.html#cb16-4" tabindex="-1"></a>  thresh_4 <span class="ot">&lt;-</span> <span class="fl">1.00</span></span>
<span id="cb16-5"><a href="anwendungsbeispiel.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="anwendungsbeispiel.html#cb16-6" tabindex="-1"></a>  accuracy_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> thresh_1, </span>
<span id="cb16-7"><a href="anwendungsbeispiel.html#cb16-7" tabindex="-1"></a>                           <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb16-8"><a href="anwendungsbeispiel.html#cb16-8" tabindex="-1"></a>                           <span class="st">&quot;No&quot;</span>) <span class="sc">==</span> sleep_data<span class="sc">$</span>sleep_problem) <span class="sc">/</span> <span class="fu">nrow</span>(sleep_data)</span>
<span id="cb16-9"><a href="anwendungsbeispiel.html#cb16-9" tabindex="-1"></a>  accuracy_2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> thresh_2, </span>
<span id="cb16-10"><a href="anwendungsbeispiel.html#cb16-10" tabindex="-1"></a>                           <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb16-11"><a href="anwendungsbeispiel.html#cb16-11" tabindex="-1"></a>                           <span class="st">&quot;No&quot;</span>) <span class="sc">==</span> sleep_data<span class="sc">$</span>sleep_problem) <span class="sc">/</span> <span class="fu">nrow</span>(sleep_data)</span>
<span id="cb16-12"><a href="anwendungsbeispiel.html#cb16-12" tabindex="-1"></a>  accuracy_3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> thresh_3, </span>
<span id="cb16-13"><a href="anwendungsbeispiel.html#cb16-13" tabindex="-1"></a>                           <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb16-14"><a href="anwendungsbeispiel.html#cb16-14" tabindex="-1"></a>                           <span class="st">&quot;No&quot;</span>) <span class="sc">==</span> sleep_data<span class="sc">$</span>sleep_problem) <span class="sc">/</span> <span class="fu">nrow</span>(sleep_data)</span>
<span id="cb16-15"><a href="anwendungsbeispiel.html#cb16-15" tabindex="-1"></a>  accuracy_4 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> thresh_4, </span>
<span id="cb16-16"><a href="anwendungsbeispiel.html#cb16-16" tabindex="-1"></a>                           <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb16-17"><a href="anwendungsbeispiel.html#cb16-17" tabindex="-1"></a>                           <span class="st">&quot;No&quot;</span>) <span class="sc">==</span> sleep_data<span class="sc">$</span>sleep_problem) <span class="sc">/</span> <span class="fu">nrow</span>(sleep_data)</span></code></pre></div>
<p>Allgemein ist man bestrebt, eine möglichst hohe Genauigkeit des Modells zu erreichen. In vorliegenden Fall beträgt die Accuracy bei 0.01 = 0.748, bei 0.25 = 0.966, usw.</p>
<p>Betrachten wir nun den vierten Schwellenwert 1. Das bedeutet, dass wir nur dann vorhersagen würden, dass eine Person eine Schlafstörung hat, wenn die vom Modell vorhergesagte Wahrscheinlichkeit für diese Person größer als 1.00 ist. <strong>Das ist aber unmöglich!</strong></p>
<p>Mit anderen Worten: Wir würden niemals vorhersagen, dass jemand eine Schlafstörung hat. Dennoch beträgt unsere Genauigkeit immer noch 96.67%.</p>
<p>Das wäre sicher <strong>kein gutes Klassifikationsmodell</strong>!</p>
<p>Da unser Datensatz <em>unausgewogen</em> ist (nur ein kleiner Prozentsatz der Personen hat eine Schlafstörung - etwa 3,3%), können wir eine hohe Genauigkeit erzielen, indem wir einfach nie vorhersagen, dass jemand eine Schlafstörung hat. Deshalb ist die Genauigkeit in diesem Fall kein ausreichendes Kriterium, um unser Klassifikationsmodell zu beurteilen.</p>
</div>
<div id="sensitivität-spezifität-und-die-konfusionsmatrix" class="section level3 hasAnchor">
<h3>Sensitivität, Spezifität und die Konfusionsmatrix<a href="anwendungsbeispiel.html#sensitivität-spezifität-und-die-konfusionsmatrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Die Konfusionsmatrix unterteilt das Klassifikationsmodell in <em>True Positives</em> (<span class="math inline">\(TP\)</span>, wahre Positive), <em>True Negatives</em> (<span class="math inline">\(TN\)</span>, wahre Negative), <em>False Positives</em> (<span class="math inline">\(FP\)</span>, falsch Positive) und <em>False Negatives</em> (<span class="math inline">\(FN\)</span>, falsch Negative).</p>
<p>Die <em>Sensitivität</em> eines Klassifikationsmodells ist definiert als der Anteil der wahren Positiven.</p>
<p><span class="math display">\[\text{Sensitivität} = \frac{TP}{TP + FN}\]</span></p>
<p><strong>Sensitivität misst also, wie gut ein Modell positive Fälle tatsächlich erkennt.</strong></p>
<p>Die <em>Spezifität</em> eines Klassifikationsmodells ist definiert als der Anteil der wahren Negativen.</p>
<p><span class="math display">\[\text{Spezitivität} = \frac{TN}{FP + TN}\]</span></p>
<p><strong>Die Spezifität misst also, wie gut ein Modell negative Fälle korrekt identifiziert.</strong></p>
<center>
<div class="float">
<img src="Images/Konfussionsmatrix.jpg" style="width:70.0%" alt="Abbildung 2: Wahrheistmatrix (Konfusionsmatrix)" />
<div class="figcaption"><strong>Abbildung 2</strong>: Wahrheistmatrix (Konfusionsmatrix)</div>
</div>
</center>
<p>Betrachten wir die Konfusionsmatrix für zwei Entscheidungsschwellenwerte, nämlich 0.01 und 0.25 und vergleichen anschließend die Ergebnisse:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="anwendungsbeispiel.html#cb17-1" tabindex="-1"></a>  <span class="fu">data.frame</span>(   <span class="at">actual =</span> sleep_data<span class="sc">$</span>sleep_problem,</span>
<span id="cb17-2"><a href="anwendungsbeispiel.html#cb17-2" tabindex="-1"></a>             <span class="at">predicted =</span> <span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> thresh_1, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span></code></pre></div>
<pre><code>##       predicted
## actual    0    1
##    No  7163 2504
##    Yes   12  321</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="anwendungsbeispiel.html#cb19-1" tabindex="-1"></a>  <span class="co">#&gt;       predicted</span></span>
<span id="cb19-2"><a href="anwendungsbeispiel.html#cb19-2" tabindex="-1"></a>  <span class="co">#&gt; actual    0    1</span></span>
<span id="cb19-3"><a href="anwendungsbeispiel.html#cb19-3" tabindex="-1"></a>  <span class="co">#&gt;      0 7163 2504</span></span>
<span id="cb19-4"><a href="anwendungsbeispiel.html#cb19-4" tabindex="-1"></a>  <span class="co">#&gt;      1   12  321</span></span>
<span id="cb19-5"><a href="anwendungsbeispiel.html#cb19-5" tabindex="-1"></a>  <span class="co">#++++++++++++++++++++++++++++++++</span></span>
<span id="cb19-6"><a href="anwendungsbeispiel.html#cb19-6" tabindex="-1"></a>  <span class="co"># Sensitivität</span></span>
<span id="cb19-7"><a href="anwendungsbeispiel.html#cb19-7" tabindex="-1"></a>  Sensitivität1 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="dv">321</span> <span class="sc">/</span> (<span class="dv">321</span> <span class="sc">+</span> <span class="dv">12</span>))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb19-8"><a href="anwendungsbeispiel.html#cb19-8" tabindex="-1"></a>  <span class="co">#&gt; [1] 0.963964</span></span>
<span id="cb19-9"><a href="anwendungsbeispiel.html#cb19-9" tabindex="-1"></a>  <span class="co">#++++++++++++++++++++++++++++++++  </span></span>
<span id="cb19-10"><a href="anwendungsbeispiel.html#cb19-10" tabindex="-1"></a>  <span class="co"># Spezifität</span></span>
<span id="cb19-11"><a href="anwendungsbeispiel.html#cb19-11" tabindex="-1"></a>  <span class="fu">round</span>((<span class="dv">7163</span> <span class="sc">/</span> (<span class="dv">7163</span> <span class="sc">+</span> <span class="dv">2504</span>))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 74.1</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="anwendungsbeispiel.html#cb21-1" tabindex="-1"></a>  <span class="co">#&gt; [1] 0.7409744</span></span>
<span id="cb21-2"><a href="anwendungsbeispiel.html#cb21-2" tabindex="-1"></a>  <span class="co">#++++++++++++++++++++++++++++++++  </span></span>
<span id="cb21-3"><a href="anwendungsbeispiel.html#cb21-3" tabindex="-1"></a>  <span class="co"># --- 0.25 Threshold ---</span></span>
<span id="cb21-4"><a href="anwendungsbeispiel.html#cb21-4" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">actual =</span> sleep_data<span class="sc">$</span>sleep_problem,</span>
<span id="cb21-5"><a href="anwendungsbeispiel.html#cb21-5" tabindex="-1"></a>             <span class="at">predicted =</span> <span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> thresh_2, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span></code></pre></div>
<pre><code>##       predicted
## actual    0    1
##    No  9477  190
##    Yes  149  184</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="anwendungsbeispiel.html#cb23-1" tabindex="-1"></a>  <span class="co">#&gt;       predicted</span></span>
<span id="cb23-2"><a href="anwendungsbeispiel.html#cb23-2" tabindex="-1"></a>  <span class="co">#&gt; actual    0    1</span></span>
<span id="cb23-3"><a href="anwendungsbeispiel.html#cb23-3" tabindex="-1"></a>  <span class="co">#&gt;      0 9477  190</span></span>
<span id="cb23-4"><a href="anwendungsbeispiel.html#cb23-4" tabindex="-1"></a>  <span class="co">#&gt;      1  149  184</span></span>
<span id="cb23-5"><a href="anwendungsbeispiel.html#cb23-5" tabindex="-1"></a>  <span class="co">#++++++++++++++++++++++++++++++++  </span></span>
<span id="cb23-6"><a href="anwendungsbeispiel.html#cb23-6" tabindex="-1"></a>  <span class="co"># Sensitivität</span></span>
<span id="cb23-7"><a href="anwendungsbeispiel.html#cb23-7" tabindex="-1"></a>  <span class="fu">round</span>((<span class="dv">184</span> <span class="sc">/</span> (<span class="dv">184</span> <span class="sc">+</span> <span class="dv">149</span>))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 55.3</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="anwendungsbeispiel.html#cb25-1" tabindex="-1"></a>  <span class="co">#&gt; [1] 0.5525526</span></span>
<span id="cb25-2"><a href="anwendungsbeispiel.html#cb25-2" tabindex="-1"></a>  <span class="co">#++++++++++++++++++++++++++++++++  </span></span>
<span id="cb25-3"><a href="anwendungsbeispiel.html#cb25-3" tabindex="-1"></a>  <span class="co"># Spezifität</span></span>
<span id="cb25-4"><a href="anwendungsbeispiel.html#cb25-4" tabindex="-1"></a>  <span class="fu">round</span>((<span class="dv">9477</span> <span class="sc">/</span> (<span class="dv">9477</span> <span class="sc">+</span> <span class="dv">190</span>))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="anwendungsbeispiel.html#cb27-1" tabindex="-1"></a>  <span class="co">#&gt; [1] 0.9803455</span></span>
<span id="cb27-2"><a href="anwendungsbeispiel.html#cb27-2" tabindex="-1"></a>  <span class="co">#++++++++++++++++++++++++++++++++</span></span></code></pre></div>
<p>Wir halten fest:</p>
<ul>
<li><p>Ein Schwellenwert (Threshold) von 0.01 identifiziert nahezu alle tatsächlichen Fälle mit Schlafproblemen korrekt (Sensitivität = <span class="math inline">\(Sensitivität1\)</span>%). Allerdings wird auch häufig vorhergesagt, dass jemand ein Schlafproblem hat, obwohl dies nicht der Fall ist (hohe Anzahl an falsch-positiven Ergebnissen).</p></li>
<li><p>Ein Schwellenwert von 0.25 übersieht hingegen oft Personen mit tatsächlicher Schlafproblemen, sagt aber im Gegenzug selten fälschlicherweise Schlafproblemen bei gesunden Personen voraus.</p></li>
</ul>
<div id="zusammenfassung-1" class="section level4 hasAnchor">
<h4>Zusammenfassung<a href="anwendungsbeispiel.html#zusammenfassung-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Welcher Schwellenwert ist also besser?</p>
<p>Wenn das Ziel darin besteht, möglichst viele Personen mit tatsächlicher Schlafproblem zu identifizieren, um zum Beispiel frühzeitig eingreifen und den Lebensstil oder die Gesundheit beeinflussen zu können, könnte ein Schwellenwert von 0.01 sinnvoll sein. So werden mehr betroffene Personen erkannt. Allerdings geht dies mit dem Nachteil einher, dass sehr viele Menschen unnötig gewarnt werden und dadurch Stress entsteht oder zusätzliche Kosten für die Versicherung anfallen, weil Personen getestet werden, die eigentlich gesund sind.</p>
<p>Was ist der größere Fehler?</p>
<p>Ist es schlimmer, Menschen zu sagen, sie könnten eine Schlafproblem haben, und sie sollten unbedingt weitere, langwierige und kostspielige Untersuchungen machen lassen, obwohl sie gar kein Problem haben? Oder ist es schlimmer, betroffene Personen nicht zu erkennen, sodass diese nicht getestet und behandelt werden? Wenn das Verpassen von Betroffenen der größere Fehler ist, sollte man einen niedrigeren Schwellenwert wie 0,01 wählen, um bei der Identifikation besonders vorsichtig zu sein.</p>
</div>
</div>
<div id="roc-auc" class="section level3 hasAnchor">
<h3>ROC &amp; AUC<a href="anwendungsbeispiel.html#roc-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Man kann die Vorhersagekraft eines Klassifikationsmodells auch visualisieren und quantifizieren, ohne vorher einen bestimmten Schwellenwert festzulegen. Wenn man die <em>Sensitivität</em> gegen die <em>Falsch-Positiv-Rate</em> (False Positive Rate) des Modells über beliebig viele <em>Schwellenwerte</em> hinweg aufträgt, erhält man die <em>Receiver-Operating-Characteristic-Kurve</em>, kurz <strong>ROC-Kurve</strong>. Die Fläche unter dieser Kurve, auch <strong>AUC</strong> (Area Under the Curve) genannt, ist eine weit verbreitete Kennzahl zum Vergleich von Klassifikationsmodellen.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="anwendungsbeispiel.html#cb28-1" tabindex="-1"></a>  <span class="co"># library(pROC)</span></span>
<span id="cb28-2"><a href="anwendungsbeispiel.html#cb28-2" tabindex="-1"></a>  true_labels <span class="ot">&lt;-</span> sleep_data<span class="sc">$</span>sleep_problem</span>
<span id="cb28-3"><a href="anwendungsbeispiel.html#cb28-3" tabindex="-1"></a>  <span class="co"># ROC-Kurve</span></span>
<span id="cb28-4"><a href="anwendungsbeispiel.html#cb28-4" tabindex="-1"></a>  roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(true_labels, pred_probs)</span></code></pre></div>
<pre><code>## Setting levels: control = No, case = Yes</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="anwendungsbeispiel.html#cb31-1" tabindex="-1"></a>  <span class="fu">plot</span>(roc_obj, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main=</span><span class="st">&quot;ROC-Kurve&quot;</span>)</span></code></pre></div>
<p><img src="01_LogisticRegression_files/figure-html/ROC-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="anwendungsbeispiel.html#cb32-1" tabindex="-1"></a>  <span class="fu">auc</span>(roc_obj)</span></code></pre></div>
<pre><code>## Area under the curve: 0.95</code></pre>
<p>Für eine ausführliche Beschreibung der ROC und AUC siehe <a href="https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc?hl=de" target="_blank">Klassifizierung: ROC und AUC</a></p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>bei den vorliegenden Daten handelt es sich um simulierte Daten!<a href="anwendungsbeispiel.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evaluierung-des-modells.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
